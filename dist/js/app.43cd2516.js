(function(){"use strict";var e={3327:function(e,t,a){var i=a(5130),o=a(6768);function n(e,t,a,i,n,r){const s=(0,o.g2)("image-editor");return(0,o.uX)(),(0,o.Wv)(s)}const r={class:"image-editor"};function s(e,t,a,i,n,s){const l=(0,o.g2)("ImageCanvas"),g=(0,o.g2)("EditPanel");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(l,{"image-src":n.imageUrl,color:n.color,"is-blurring":n.isBlurring,size:n.size,iteration:n.iteration,loadFromStorage:n.loadFromStorage,origImage:n.origImage,onGetImageUrl:t[0]||(t[0]=e=>n.imageSaveUrl=e),onNewEdit:t[1]||(t[1]=e=>{n.iteration++,n.iterMax=n.iteration,n.loadFromStorage=!1}),onResetStorage:t[2]||(t[2]=e=>n.iteration=n.iterMax=0)},null,8,["image-src","color","is-blurring","size","iteration","loadFromStorage","origImage"]),(0,o.bF)(g,{"image-save-url":n.imageSaveUrl,"is-blurring":n.isBlurring,size:n.size,iteration:n.iteration,onImageUploaded:t[3]||(t[3]=e=>{n.imageUrl=e,n.origImage=e}),onColorChanged:t[4]||(t[4]=e=>n.color=e),onToolChanged:t[5]||(t[5]=e=>n.isBlurring=e),onSizeChanged:t[6]||(t[6]=e=>n.size=e),onUndoImage:t[7]||(t[7]=e=>{n.iteration>0?n.iteration--:n.iteration,n.iteration<n.iterMax?n.loadFromStorage=!0:n.loadFromStorage=!1}),onRedoImage:t[8]||(t[8]=e=>{n.iteration<n.iterMax?n.iteration++:n.iteration,n.iteration<=n.iterMax?n.loadFromStorage=!0:n.loadFromStorage=!1})},null,8,["image-save-url","is-blurring","size","iteration"])])}const l={ref:"shit",class:"ground"};function g(e,t,a,i,n,r){return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("canvas",{onMousedown:t[0]||(t[0]=(...e)=>r.startDrawing&&r.startDrawing(...e)),onMousemove:t[1]||(t[1]=(...e)=>r.draw&&r.draw(...e)),onMouseleave:t[2]||(t[2]=(...e)=>r.stopDrawing&&r.stopDrawing(...e)),onMouseup:t[3]||(t[3]=(...e)=>r.stopDrawing&&r.stopDrawing(...e)),id:"canvas"},null,32)],512)}a(4603),a(7566),a(8721);var d={name:"ImageCanvas",props:{imageSrc:{type:String,default:""},color:{type:String,default:"black"},isBlurring:{type:Boolean,default:!1},size:{type:Number,default:25},iteration:{type:Number,default:0},loadFromStorage:{type:Boolean,default:!1},origImage:{type:String,default:""}},emits:["getImageUrl","new-edit","reset-storage"],data(){return{canvas:null,context:null,ground:null,isDrawing:!1}},watch:{imageSrc(e){localStorage.clear(),this.$emit("reset-storage");const t=new Image;t.src=e,t.addEventListener("load",(()=>{this.drawOnImage(t)})),this.imageUrl=this.canvas.toDataURL("image/png"),this.$emit("getImageUrl",this.imageUrl),this.saveEdit()},iteration(e){if(this.loadFromStorage){const t=localStorage.getItem(`edit-${e}`),a=new Image;0===e?(a.src=this.origImage,this.$emit("getImageUrl",this.origImage)):(a.src=t,this.$emit("getImageUrl",t)),a.addEventListener("load",(()=>{this.drawOnImage(a)}))}}},methods:{drawOnImage(e=null){if(e){const t=e.width/e.height,a=this.ground.clientHeight,i=a*t;this.canvas.height=a,this.canvas.width=i,this.context.drawImage(e,0,0,i,a)}},saveEdit(){this.canvas.toBlob((e=>{const t=URL.createObjectURL(e);localStorage.setItem(`edit-${this.iteration}`,t)}))},applyBlur(e,t){const a=this.size/16,i=this.context.getImageData(e-a,t-a,2*a+1,2*a+1),o=document.createElement("canvas");o.width=2*a+1,o.height=2*a+1;const n=o.getContext("2d");n.putImageData(i,0,0),n.globalAlpha=.5,n.drawImage(o,-a/4,-a/4,2.5*a,2.5*a);const r=n.getImageData(0,0,o.width,o.height),s=2*a+1,l=Math.floor(s/2),g=Math.floor(s/2),d=r.data,c=i.data;for(let u=0,m=0;u<d.length;u+=4,m++){const e=m%s,t=Math.floor(m/s);(e-l)**2+(t-g)**2<=a**2||(d[u]=c[u],d[u+1]=c[u+1],d[u+2]=c[u+2],d[u+3]=c[u+3])}this.context.putImageData(r,e-a,t-a)},startDrawing(e){this.imageSrc&&(this.isDrawing=!0,this.draw(e))},stopDrawing(){if(this.isDrawing){this.isDrawing=!1,this.imageUrl=this.canvas.toDataURL("image/png"),this.$emit("getImageUrl",this.imageUrl),this.$emit("new-edit"),this.saveEdit();for(let e=this.iteration+1;e<localStorage.length;e++)localStorage.removeItem(`edit-${e}`)}},draw(e){if(this.isDrawing){const t=e.pageX-this.canvas.offsetLeft,a=e.pageY-this.canvas.offsetTop;this.context.beginPath(),this.context.lineWidth=this.size/5,this.context.strokeStyle=this.color,this.context.lineJoin="round",this.context.lineCap="round",this.context.moveTo(t,a),this.isBlurring?this.applyBlur(t,a):(this.context.lineTo(t,a),this.context.stroke())}}},mounted(){this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.ground=document.querySelector(".ground")}},c=a(1241);const u=(0,c.A)(d,[["render",g],["__scopeId","data-v-0945155c"]]);var m=u,h=a(4232);const f={class:"edit-panel"},v={class:"tools"},p=["onClick"],b={class:"brush-size"},I=["value"],w={class:"controls"};function k(e,t,a,i,n,r){const s=(0,o.g2)("u-i-h2"),l=(0,o.g2)("u-i-button");return(0,o.uX)(),(0,o.CE)("div",f,[(0,o.bF)(s,null,{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("Tool")]))),_:1}),(0,o.Lk)("div",v,[(0,o.bF)(l,{onClick:t[0]||(t[0]=t=>e.$emit("tool-changed",!1)),id:"brush-tool"},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("Brush")]))),_:1}),(0,o.bF)(l,{onClick:t[1]||(t[1]=t=>e.$emit("tool-changed",!0)),id:"blur-tool"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)("Blur")]))),_:1})]),(0,o.bF)(s,{class:(0,h.C4)(a.isBlurring?"hide ":"nothing")},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("Color")]))),_:1},8,["class"]),(0,o.Lk)("div",{class:(0,h.C4)([a.isBlurring?"hide":"nothing","colors color-scheme"])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.colors,(t=>((0,o.uX)(),(0,o.CE)("button",{onClick:a=>e.$emit("color-changed",t),key:t,class:(0,h.C4)(t)},null,10,p)))),128))],2),(0,o.bF)(s,null,{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("Size")]))),_:1}),(0,o.Lk)("label",b,[(0,o.Lk)("input",{onChange:t[2]||(t[2]=t=>{e.$emit("size-changed",t.target.value)}),id:"tool-size",value:this.size,min:"10",max:"100",type:"range"},null,40,I)]),(0,o.Lk)("div",w,[(0,o.Lk)("label",null,[t[12]||(t[12]=(0,o.eW)("Upload Image ")),(0,o.Lk)("input",{onChange:t[3]||(t[3]=(...e)=>r.imageUpload&&r.imageUpload(...e)),id:"file-input",type:"file"},null,32)]),(0,o.Lk)("a",{download:"",id:"save",onClick:t[4]||(t[4]=e=>r.saveImage(a.imageSaveUrl))},"Save"),(0,o.bF)(l,{onClick:t[5]||(t[5]=t=>e.$emit("undo-image"))},{default:(0,o.k6)((()=>t[13]||(t[13]=[(0,o.eW)("Undo")]))),_:1}),(0,o.bF)(l,{onClick:t[6]||(t[6]=t=>e.$emit("redo-image"))},{default:(0,o.k6)((()=>t[14]||(t[14]=[(0,o.eW)("Redo")]))),_:1})])])}function S(e,t){return(0,o.uX)(),(0,o.CE)("button",null,[(0,o.RG)(e.$slots,"default",{},void 0,!0)])}const U={},C=(0,c.A)(U,[["render",S],["__scopeId","data-v-fb5dca30"]]);var y=C;function x(e,t){return(0,o.uX)(),(0,o.CE)("h2",null,[(0,o.RG)(e.$slots,"default",{},void 0,!0)])}const E={},F=(0,c.A)(E,[["render",x],["__scopeId","data-v-48c70bb2"]]);var _=F,D={name:"EditPanel",components:{UIButton:y,UIH2:_},props:{imageSaveUrl:{type:String,default:""},isBlurring:{type:Boolean,default:!1},size:{type:Number,default:25},iteration:{type:Number,default:0}},emits:["image-uploaded","color-changed","tool-changed","size-changed","undo-image","redo-image"],data(){return{colors:["red","yellow","lime","deepskyblue","purple","black","white"]}},methods:{async imageUpload(e){const t=e.target.files[0];if(t){const e=await this.fileToDataUri(t);this.$emit("image-uploaded",e)}},fileToDataUri(e){return new Promise((t=>{const a=new FileReader;a.addEventListener("load",(()=>{t(a.result)})),a.readAsDataURL(e)}))},saveImage(e){const t=document.getElementById("save");t.href=e,t.download="EternalImage"}}};const B=(0,c.A)(D,[["render",k],["__scopeId","data-v-2523b790"]]);var z=B,L={components:{EditPanel:z,ImageCanvas:m},data(){return{imageUrl:"",imageSaveUrl:"",origImage:"",color:"black",size:25,isBlurring:!1,iteration:0,iterMax:0,loadFromStorage:!1}}};const $=(0,c.A)(L,[["render",s],["__scopeId","data-v-23512c94"]]);var O=$,M={name:"App",components:{ImageEditor:O}};const R=(0,c.A)(M,[["render",n]]);var W=R;(0,i.Ef)(W).mount("#app")}},t={};function a(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,i,o,n){if(!i){var r=1/0;for(d=0;d<e.length;d++){i=e[d][0],o=e[d][1],n=e[d][2];for(var s=!0,l=0;l<i.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((function(e){return a.O[e](i[l])}))?i.splice(l--,1):(s=!1,n<r&&(r=n));if(s){e.splice(d--,1);var g=o();void 0!==g&&(t=g)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[i,o,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var o,n,r=i[0],s=i[1],l=i[2],g=0;if(r.some((function(t){return 0!==e[t]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(l)var d=l(a)}for(t&&t(i);g<r.length;g++)n=r[g],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},i=self["webpackChunkcodex_front_vue"]=self["webpackChunkcodex_front_vue"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(3327)}));i=a.O(i)})();
//# sourceMappingURL=app.43cd2516.js.map