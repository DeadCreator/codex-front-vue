(function(){"use strict";var t={6353:function(t,e,a){var n=a(5130),i=a(6768);function o(t,e,a,n,o,s){const r=(0,i.g2)("image-editor");return(0,i.uX)(),(0,i.Wv)(r)}const s={class:"image-editor"};function r(t,e,a,n,o,r){const l=(0,i.g2)("ImageCanvas"),d=(0,i.g2)("EditPanel");return(0,i.uX)(),(0,i.CE)("div",s,[(0,i.bF)(l),(0,i.bF)(d)])}const l={class:"ground"};function d(t,e,a,n,o,s){return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("canvas",{onMousedown:e[0]||(e[0]=(...t)=>s.startDrawing&&s.startDrawing(...t)),onMousemove:e[1]||(e[1]=(...t)=>s.draw&&s.draw(...t)),onMouseleave:e[2]||(e[2]=(...t)=>s.stopDrawing&&s.stopDrawing(...t)),onMouseup:e[3]||(e[3]=(...t)=>s.stopDrawing&&s.stopDrawing(...t)),id:"canvas"},null,32)])}var u=a(5234);const c=(0,u.nY)("images",{state:()=>({iteration:0,imgUrl:"",imageEdits:[],isDrawing:!1,isBlurring:!1,newUpload:!1,color:"black",size:"15"}),actions:{newUploaded(t){this.newUpload=t},removeRedos(){if(this.imageEdits.length-this.iteration>1)for(let t=this.iteration;t<this.imageEdits.length;t++)this.imageEdits.pop()},resetEdits(){this.imageEdits=[],this.iteration=0},switchDrawing(t){this.isDrawing=t},updateColor(t){this.color=t},updateIteration(t){this.iteration+=t},updateImageEdits(t,e){this.imageEdits[t]=e},updateMode(t){this.isBlurring=t},updateSize(t){this.size=t},updateUrl(t){this.imgUrl=t}}});var g={name:"ImageCanvas",computed:{...(0,u.aH)(c,["imgUrl"]),...(0,u.aH)(c,["imageEdits"]),...(0,u.aH)(c,["isDrawing"]),...(0,u.aH)(c,["isBlurring"]),...(0,u.aH)(c,["iteration"]),...(0,u.aH)(c,["newUpload"]),...(0,u.aH)(c,["color"]),...(0,u.aH)(c,["size"])},data(){return{canvas:null,context:null,ground:null}},watch:{imgUrl(){const t=c();if(this.newUpload){t.resetEdits();const e=new Image;e.src=this.imgUrl,e.addEventListener("load",(()=>{this.drawOnImage(e),t.updateImageEdits(0,this.canvas.toDataURL("image/png"))})),t.newUploaded(!1)}else t.updateImageEdits(this.iteration,this.canvas.toDataURL("image/png"))},iteration(){const t=c(),e=new Image;e.src=this.imageEdits[this.iteration],e.onload=()=>{this.context.drawImage(e,0,0,this.canvas.width,this.canvas.height),t.updateUrl(this.canvas.toDataURL("image/png"))}}},methods:{drawOnImage(t=null){if(t){const e=t.width/t.height,a=this.ground.clientHeight,n=a*e;this.canvas.height=a,this.canvas.width=n,this.context.drawImage(t,0,0,n,a)}},applyBlur(t,e){const a=this.size/16,n=this.context.getImageData(t-a,e-a,2*a+1,2*a+1),i=document.createElement("canvas");i.width=2*a+1,i.height=2*a+1;const o=i.getContext("2d");o.putImageData(n,0,0),o.globalAlpha=.5,o.drawImage(i,-a/4,-a/4,2.5*a,2.5*a);const s=o.getImageData(0,0,i.width,i.height),r=2*a+1,l=Math.floor(r/2),d=Math.floor(r/2),u=s.data,c=n.data;for(let g=0,h=0;g<u.length;g+=4,h++){const t=h%r,e=Math.floor(h/r);(t-l)**2+(e-d)**2<=a**2||(u[g]=c[g],u[g+1]=c[g+1],u[g+2]=c[g+2],u[g+3]=c[g+3])}this.context.putImageData(s,t-a,e-a)},startDrawing(t){if(this.imgUrl){const e=c();e.switchDrawing(!0);const a=t.pageX-this.canvas.offsetLeft,n=t.pageY-this.canvas.offsetTop;this.context.beginPath(),this.context.lineWidth=this.size/5,this.context.strokeStyle=this.color,this.context.lineJoin="round",this.context.lineCap="round",this.context.moveTo(a,n),this.draw(t)}},stopDrawing(){if(this.isDrawing){const t=c();t.switchDrawing(!1),t.updateIteration(1),t.updateUrl(this.canvas.toDataURL("image/png")),t.updateImageEdits(this.iteration,this.canvas.toDataURL("image/png")),t.removeRedos()}},draw(t){if(this.isDrawing){const e=t.pageX-this.canvas.offsetLeft,a=t.pageY-this.canvas.offsetTop;this.isBlurring?this.applyBlur(e,a):this.context.stroke(),this.context.lineTo(e,a)}}},mounted(){this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.ground=document.querySelector(".ground")}},h=a(1241);const p=(0,h.A)(g,[["render",d],["__scopeId","data-v-10c1c6f4"]]);var m=p,f=a(4232);const v={class:"edit-panel"},w={class:"tools"},I=["onClick"],b={class:"brush-size"},E=["value"],k={class:"controls"};function U(t,e,a,n,o,s){const r=(0,i.g2)("u-i-h2"),l=(0,i.g2)("u-i-button");return(0,i.uX)(),(0,i.CE)("div",v,[(0,i.bF)(r,null,{default:(0,i.k6)((()=>e[7]||(e[7]=[(0,i.eW)("Tool")]))),_:1}),(0,i.Lk)("div",w,[(0,i.bF)(l,{onClick:e[0]||(e[0]=()=>{s.useImageStore().updateMode(!1)}),id:"brush-tool"},{default:(0,i.k6)((()=>e[8]||(e[8]=[(0,i.eW)("Brush")]))),_:1}),(0,i.bF)(l,{onClick:e[1]||(e[1]=()=>{s.useImageStore().updateMode(!0)}),id:"blur-tool"},{default:(0,i.k6)((()=>e[9]||(e[9]=[(0,i.eW)("Blur")]))),_:1})]),(0,i.bF)(r,{class:(0,f.C4)(t.isBlurring?"hide ":"nothing")},{default:(0,i.k6)((()=>e[10]||(e[10]=[(0,i.eW)("Color")]))),_:1},8,["class"]),(0,i.Lk)("div",{class:(0,f.C4)([t.isBlurring?"hide":"nothing","colors color-scheme"])},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.colors,(t=>((0,i.uX)(),(0,i.CE)("button",{onClick:()=>{s.useImageStore().updateColor(t)},key:t,class:(0,f.C4)(t)},null,10,I)))),128))],2),(0,i.bF)(r,null,{default:(0,i.k6)((()=>e[11]||(e[11]=[(0,i.eW)("Size")]))),_:1}),(0,i.Lk)("label",b,[(0,i.Lk)("input",{onChange:e[2]||(e[2]=t=>{s.useImageStore().updateSize(t.target.value)}),id:"tool-size",value:this.size,min:"10",max:"100",type:"range"},null,40,E)]),(0,i.Lk)("div",k,[(0,i.Lk)("label",null,[e[12]||(e[12]=(0,i.eW)("Upload Image ")),(0,i.Lk)("input",{onChange:e[3]||(e[3]=(...t)=>s.imageUpload&&s.imageUpload(...t)),id:"file-input",type:"file"},null,32)]),(0,i.Lk)("a",{download:"",id:"save",onClick:e[4]||(e[4]=t=>s.saveImage())},"Save"),(0,i.bF)(l,{onClick:e[5]||(e[5]=t=>s.undoCanvas(-1))},{default:(0,i.k6)((()=>e[13]||(e[13]=[(0,i.eW)("Undo")]))),_:1}),(0,i.bF)(l,{onClick:e[6]||(e[6]=t=>s.redoCanvas(1))},{default:(0,i.k6)((()=>e[14]||(e[14]=[(0,i.eW)("Redo")]))),_:1})])])}function C(t,e){return(0,i.uX)(),(0,i.CE)("button",null,[(0,i.RG)(t.$slots,"default",{},void 0,!0)])}const D={},x=(0,h.A)(D,[["render",C],["__scopeId","data-v-fb5dca30"]]);var _=x;function y(t,e){return(0,i.uX)(),(0,i.CE)("h2",null,[(0,i.RG)(t.$slots,"default",{},void 0,!0)])}const L={},B=(0,h.A)(L,[["render",y],["__scopeId","data-v-48c70bb2"]]);var F=B,H={name:"EditPanel",components:{UIButton:_,UIH2:F},computed:{...(0,u.aH)(c,["iteration"]),...(0,u.aH)(c,["imageEdits"]),...(0,u.aH)(c,["isBlurring"])},data(){return{colors:["red","yellow","lime","deepskyblue","purple","black","white"]}},methods:{useImageStore:c,async imageUpload(t){const e=t.target.files[0];if(e){const t=await this.fileToDataUri(e),a=c();a.updateUrl(t),a.newUploaded(!0)}},fileToDataUri(t){return new Promise((e=>{const a=new FileReader;a.addEventListener("load",(()=>{e(a.result)})),a.readAsDataURL(t)}))},saveImage(){const t=document.getElementById("save"),e=c();t.href=e.imgUrl,t.download="EternalImage"+Math.floor((new Date).getTime()/1e3)},undoCanvas(t){if(this.iteration>0){const e=c();e.updateIteration(t)}},redoCanvas(t){if(this.imageEdits.length>this.iteration+1){const e=c();e.updateIteration(t)}}}};const M=(0,h.A)(H,[["render",U],["__scopeId","data-v-57c8e7d4"]]);var O=M,S={components:{EditPanel:O,ImageCanvas:m},data(){return{imageUrl:"",imageSaveUrl:"",origImage:"",color:"black",size:25,isBlurring:!1,iteration:0,iterMax:0,loadFromStorage:!1}}};const z=(0,h.A)(S,[["render",r],["__scopeId","data-v-5657524e"]]);var R=z,T={name:"App",components:{ImageEditor:R}};const W=(0,h.A)(T,[["render",o]]);var X=W;const A=(0,u.Ey)();(0,n.Ef)(X).use(A).mount("#app")}},e={};function a(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,a),o.exports}a.m=t,function(){var t=[];a.O=function(e,n,i,o){if(!n){var s=1/0;for(u=0;u<t.length;u++){n=t[u][0],i=t[u][1],o=t[u][2];for(var r=!0,l=0;l<n.length;l++)(!1&o||s>=o)&&Object.keys(a.O).every((function(t){return a.O[t](n[l])}))?n.splice(l--,1):(r=!1,o<s&&(s=o));if(r){t.splice(u--,1);var d=i();void 0!==d&&(e=d)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[n,i,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,n){var i,o,s=n[0],r=n[1],l=n[2],d=0;if(s.some((function(e){return 0!==t[e]}))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(l)var u=l(a)}for(e&&e(n);d<s.length;d++)o=s[d],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(u)},n=self["webpackChunkcodex_front_vue"]=self["webpackChunkcodex_front_vue"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(6353)}));n=a.O(n)})();
//# sourceMappingURL=app.2478fd64.js.map