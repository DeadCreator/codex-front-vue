(function(){"use strict";var t={3292:function(t,e,i){var n=i(5130),a=i(6768);function s(t,e,i,n,s,o){const r=(0,a.g2)("image-editor");return(0,a.uX)(),(0,a.Wv)(r)}const o={class:"image-editor"};function r(t,e,i,n,s,r){const l=(0,a.g2)("ImageCanvas"),c=(0,a.g2)("EditPanel");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(l),(0,a.bF)(c)])}var l=i(4232);const c={class:"ground"};function h(t,e,i,n,s,o){return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("canvas",{onMousemove:e[0]||(e[0]=(...t)=>o.draw&&o.draw(...t)),onMousedown:e[1]||(e[1]=(...t)=>o.startDrawing&&o.startDrawing(...t)),onMouseup:e[2]||(e[2]=(...t)=>o.stopDrawing&&o.stopDrawing(...t)),onMouseleave:e[3]||(e[3]=(...t)=>o.stopDrawing&&o.stopDrawing(...t)),id:"canvas"},null,32),(0,a.Lk)("div",{style:(0,l.Tr)(`width: ${this.size/5}px; height: ${this.size/5}px`),class:"circle"},null,4)])}var d=i(5234);const u=(0,d.nY)("images",{state:()=>({iteration:0,imgUrl:"",imageEdits:[],isDrawing:!1,isBlurring:!1,newUpload:!1,color:"black",colors:["#ff4c4c","#ffe629","#10f549","#35a4ff","#a467ff","black","white"],size:"50"}),actions:{newUploaded(t){this.newUpload=t},removeRedos(){while(this.imageEdits.length-this.iteration>1)this.imageEdits.pop()},resetEdits(){this.imageEdits=[],this.iteration=0},switchDrawing(t){this.isDrawing=t},updateColor(t){this.color=t},updateIteration(t){this.iteration+=t},updateImageEdits(t,e){this.imageEdits[t]=e},updateMode(t){this.isBlurring=t},updateSize(t){this.size=t},updateUrl(t){this.imgUrl=t}}});var g={name:"ImageCanvas",computed:{...(0,d.aH)(u,["imgUrl"]),...(0,d.aH)(u,["imageEdits"]),...(0,d.aH)(u,["isDrawing"]),...(0,d.aH)(u,["isBlurring"]),...(0,d.aH)(u,["iteration"]),...(0,d.aH)(u,["newUpload"]),...(0,d.aH)(u,["color"]),...(0,d.aH)(u,["size"])},data(){return{canvas:null,context:null,circle:null,ground:null,kernel:[[.0625,.125,.0625],[.125,.25,.125],[.0625,.125,.0625]]}},watch:{imgUrl(){const t=u();if(this.newUpload){t.resetEdits();const e=new Image;e.src=this.imgUrl,e.addEventListener("load",(()=>{this.drawOnImage(e),t.updateImageEdits(0,this.canvas.toDataURL("image/png"))})),t.newUploaded(!1)}else t.updateImageEdits(this.iteration,this.imgUrl)},iteration(){const t=u(),e=new Image;e.src=this.imageEdits[this.iteration],e.onload=()=>{this.context.drawImage(e,0,0,this.canvas.width,this.canvas.height),t.updateUrl(this.canvas.toDataURL("image/png"))}}},methods:{drawOnImage(t=null){if(t){const e=t.width/t.height,i=this.ground.clientHeight,n=i*e;this.canvas.height=i,this.canvas.width=n,this.context.drawImage(t,0,0,n,i)}},applyBlur(t,e){const i=Math.floor(Math.sqrt(this.size)),n=i%2===0?3*(i+1):3*i,a=Math.floor((n-1)/2);if(t-a>0&&e-a>0&&this.canvas.width-t-a>0&&this.canvas.height-e-a>0){const i=this.context.getImageData(t-a,e-a,n,n),s=Math.floor(n/2),o=Math.floor(n/2),r=i.data,l=this.context.createImageData(n,n);l.data.set(r);const c=l.data;for(let t=4*n;t<r.length-4*n;t+=12*n)for(let e=4;e<4*(n-1);e+=12){const i=[e+t-4-4*n,e+t-4*n,e+t+4-4*n,e+t-4,e+t,e+t+4,e+t-4+4*n,e+t+4*n,e+t+4+4*n],a=r[e-4-4*n+t]*this.kernel[0][0]+r[e-4*n+4+t]*this.kernel[0][1]+r[e-4*n+4+8+t]*this.kernel[0][2]+r[e-4+t]*this.kernel[1][0]+r[e+4+t]*this.kernel[1][1]+r[e+4+8+t]*this.kernel[1][2]+r[e+4+4*n+t]*this.kernel[2][0]+r[e+4*n+4+t]*this.kernel[2][1]+r[e+4*n+4+8+t]*this.kernel[2][2],s=r[e-4-4*n+1+t]*this.kernel[0][0]+r[e-4*n+5+t]*this.kernel[0][1]+r[e-4*n+4+9+t]*this.kernel[0][2]+r[e-4+1+t]*this.kernel[1][0]+r[e+5+t]*this.kernel[1][1]+r[e+4+9+t]*this.kernel[1][2]+r[e+4+4*n+1+t]*this.kernel[2][0]+r[e+4*n+5+t]*this.kernel[2][1]+r[e+4*n+4+9+t]*this.kernel[2][2],o=r[e-4-4*n+2+t]*this.kernel[0][0]+r[e-4*n+6+t]*this.kernel[0][1]+r[e-4*n+4+10+t]*this.kernel[0][2]+r[e-4+2+t]*this.kernel[1][0]+r[e+6+t]*this.kernel[1][1]+r[e+4+10+t]*this.kernel[1][2]+r[e+4+4*n+2+t]*this.kernel[2][0]+r[e+4*n+6+t]*this.kernel[2][1]+r[e+4*n+4+10+t]*this.kernel[2][2],l=r[e-4-4*n+3+t]*this.kernel[0][0]+r[e-4*n+7+t]*this.kernel[0][1]+r[e-4*n+4+11+t]*this.kernel[0][2]+r[e-4+3+t]*this.kernel[1][0]+r[e+7+t]*this.kernel[1][1]+r[e+4+11+t]*this.kernel[1][2]+r[e+4+4*n+3+t]*this.kernel[2][0]+r[e+4*n+7+t]*this.kernel[2][1]+r[e+4*n+4+11+t]*this.kernel[2][2];i.forEach((t=>{c[t]=a,c[t+1]=s,c[t+2]=o,c[t+3]=l}))}for(let t=0,e=0;t<c.length;t+=4,e++){const i=e%n,l=Math.floor(e/n);(i-s)**2+(l-o)**2<=a**2||(c[t]=r[t],c[t+1]=r[t+1],c[t+2]=r[t+2],c[t+3]=r[t+3])}this.context.putImageData(l,t-a,e-a)}},startDrawing(t){if(this.imgUrl){this.circle.style.display="block";const e=u();e.switchDrawing(!0);const i=t.pageX-this.canvas.offsetLeft,n=t.pageY-this.canvas.offsetTop;this.context.beginPath(),this.context.lineWidth=this.size/5,this.context.strokeStyle=this.color,this.context.lineJoin="round",this.context.lineCap="round",this.context.moveTo(i,n),this.draw(t)}},stopDrawing(){if(this.isDrawing){const t=u();t.switchDrawing(!1),t.updateIteration(1),t.updateUrl(this.canvas.toDataURL("image/png")),t.updateImageEdits(this.iteration,this.canvas.toDataURL("image/png")),t.removeRedos()}this.circle.style.display="none"},draw(t){const e=t.pageX-this.canvas.offsetLeft,i=t.pageY-this.canvas.offsetTop;this.isDrawing&&(this.isBlurring?this.applyBlur(e,i):this.context.stroke(),this.context.lineTo(e,i)),this.circle.style.position="absolute",this.circle.style.display="block",this.circle.style.left=t.clientX-this.size/10+"px",this.circle.style.top=t.clientY-this.size/10+"px"}},mounted(){this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.ground=document.querySelector(".ground"),this.circle=document.querySelector(".circle"),this.canvas.willUpdateFrequently=!0}},p=i(1241);const f=(0,p.A)(g,[["render",h],["__scopeId","data-v-010b196c"]]);var v=f;const m={class:"edit-panel"},k={class:"tools"},w=["onClick"],C={class:"brush-size"},I=["value"],b={class:"controls"};function E(t,e,i,n,s,o){const r=(0,a.g2)("u-i-h2"),c=(0,a.g2)("u-i-button");return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.bF)(r,null,{default:(0,a.k6)((()=>e[7]||(e[7]=[(0,a.eW)("Tool")]))),_:1}),(0,a.Lk)("div",k,[(0,a.bF)(c,{onClick:e[0]||(e[0]=()=>{o.useImageStore().updateMode(!1)}),id:"brush-tool"},{default:(0,a.k6)((()=>e[8]||(e[8]=[(0,a.eW)("Brush")]))),_:1}),(0,a.bF)(c,{onClick:e[1]||(e[1]=()=>{o.useImageStore().updateMode(!0)}),id:"blur-tool"},{default:(0,a.k6)((()=>e[9]||(e[9]=[(0,a.eW)("Blur")]))),_:1})]),(0,a.bF)(r,{class:(0,l.C4)(t.isBlurring?"hide ":"nothing")},{default:(0,a.k6)((()=>e[10]||(e[10]=[(0,a.eW)("Color")]))),_:1},8,["class"]),(0,a.Lk)("div",{class:(0,l.C4)([t.isBlurring?"hide":"nothing","colors color-scheme"])},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.colors,(t=>((0,a.uX)(),(0,a.CE)("button",{onClick:()=>{o.useImageStore().updateColor(t)},key:t,class:(0,l.C4)({active:t===this.color}),style:(0,l.Tr)(`background-color: ${t};`)},null,14,w)))),128))],2),(0,a.bF)(r,null,{default:(0,a.k6)((()=>e[11]||(e[11]=[(0,a.eW)("Size")]))),_:1}),(0,a.Lk)("label",C,[(0,a.Lk)("input",{onChange:e[2]||(e[2]=t=>{o.useImageStore().updateSize(t.target.value),console.log(t.target.value)}),id:"tool-size",value:this.size,min:"40",max:"120",type:"range"},null,40,I)]),(0,a.Lk)("div",b,[(0,a.Lk)("label",null,[e[12]||(e[12]=(0,a.eW)("Upload Image ")),(0,a.Lk)("input",{onChange:e[3]||(e[3]=(...t)=>o.imageUpload&&o.imageUpload(...t)),id:"file-input",type:"file"},null,32)]),(0,a.Lk)("a",{download:"",id:"save",onClick:e[4]||(e[4]=t=>o.saveImage())},"Save"),(0,a.bF)(c,{onClick:e[5]||(e[5]=t=>o.undoCanvas(-1))},{default:(0,a.k6)((()=>e[13]||(e[13]=[(0,a.Lk)("svg",{width:"13",height:"12",viewBox:"0 0 13 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M3.77778 7.3889L1 4.61112L3.77778 1.83334M1 4.61112H8.63889C9.3756 4.61112 10.0821 4.90378 10.6031 5.42471C11.124 5.94565 11.4167 6.65219 11.4167 7.3889C11.4167 8.12561 11.124 8.83215 10.6031 9.35308C10.0821 9.87402 9.3756 10.1667 8.63889 10.1667H7.94444",stroke:"#F5F5F5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))),_:1}),(0,a.bF)(c,{onClick:e[6]||(e[6]=t=>o.redoCanvas(1))},{default:(0,a.k6)((()=>e[14]||(e[14]=[(0,a.Lk)("svg",{width:"13",height:"12",viewBox:"0 0 13 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M9.22222 7.3889L12 4.61112L9.22222 1.83334M12 4.61112H4.36111C3.6244 4.61112 2.91786 4.90378 2.39693 5.42471C1.87599 5.94565 1.58333 6.65219 1.58333 7.3889C1.58333 8.12561 1.87599 8.83215 2.39693 9.35308C2.91786 9.87402 3.6244 10.1667 4.36111 10.1667H5.05556",stroke:"#F5F5F5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))),_:1})])])}function U(t,e){return(0,a.uX)(),(0,a.CE)("button",null,[(0,a.RG)(t.$slots,"default",{},void 0,!0)])}const x={},y=(0,p.A)(x,[["render",U],["__scopeId","data-v-6d8b9e0f"]]);var D=y;function L(t,e){return(0,a.uX)(),(0,a.CE)("h2",null,[(0,a.RG)(t.$slots,"default",{},void 0,!0)])}const _={},F=(0,p.A)(_,[["render",L],["__scopeId","data-v-4641a2aa"]]);var H=F,M={name:"EditPanel",components:{UIButton:D,UIH2:H},computed:{...(0,d.aH)(u,["iteration"]),...(0,d.aH)(u,["imageEdits"]),...(0,d.aH)(u,["isBlurring"]),...(0,d.aH)(u,["size"]),...(0,d.aH)(u,["colors"]),...(0,d.aH)(u,["color"])},methods:{useImageStore:u,async imageUpload(t){const e=t.target.files[0];if(e){const t=await this.fileToDataUri(e),i=u();i.updateUrl(t),i.newUploaded(!0)}},fileToDataUri(t){return new Promise((e=>{const i=new FileReader;i.addEventListener("load",(()=>{e(i.result)})),i.readAsDataURL(t)}))},saveImage(){const t=document.getElementById("save"),e=u();t.href=e.imgUrl,t.download="EternalImage"+Math.floor((new Date).getTime()/1e3)},undoCanvas(t){if(this.iteration>0){const e=u();e.updateIteration(t)}},redoCanvas(t){if(this.imageEdits.length>this.iteration+1){const e=u();e.updateIteration(t)}}}};const z=(0,p.A)(M,[["render",E],["__scopeId","data-v-48035058"]]);var B=z,S={components:{EditPanel:B,ImageCanvas:v},data(){return{imageUrl:"",imageSaveUrl:"",origImage:"",color:"black",size:25,isBlurring:!1,iteration:0,iterMax:0,loadFromStorage:!1}}};const O=(0,p.A)(S,[["render",r],["__scopeId","data-v-5657524e"]]);var T=O,X={name:"App",components:{ImageEditor:T}};const R=(0,p.A)(X,[["render",s]]);var j=R;const A=(0,d.Ey)();(0,n.Ef)(j).use(A).mount("#app")}},e={};function i(n){var a=e[n];if(void 0!==a)return a.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.m=t,function(){var t=[];i.O=function(e,n,a,s){if(!n){var o=1/0;for(h=0;h<t.length;h++){n=t[h][0],a=t[h][1],s=t[h][2];for(var r=!0,l=0;l<n.length;l++)(!1&s||o>=s)&&Object.keys(i.O).every((function(t){return i.O[t](n[l])}))?n.splice(l--,1):(r=!1,s<o&&(o=s));if(r){t.splice(h--,1);var c=a();void 0!==c&&(e=c)}}return e}s=s||0;for(var h=t.length;h>0&&t[h-1][2]>s;h--)t[h]=t[h-1];t[h]=[n,a,s]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,n){var a,s,o=n[0],r=n[1],l=n[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(l)var h=l(i)}for(e&&e(n);c<o.length;c++)s=o[c],i.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return i.O(h)},n=self["webpackChunkcodex_front_vue"]=self["webpackChunkcodex_front_vue"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],(function(){return i(3292)}));n=i.O(n)})();
//# sourceMappingURL=app.299a7ced.js.map